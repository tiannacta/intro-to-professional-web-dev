<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>14.5. TDD in Action &#8212; Introduction to Professional Web Development in JavaScript  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/launchcode.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/site.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="14.6. Exercises: Unit Testing" href="exercises.html" />
    <link rel="prev" title="14.4. Test-Driven Development" href="tdd.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body class="body-bc">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
        </a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<ol class="breadcrumb container">
    <li><a href="../../index.html">Contents</a></li>
    <li><a href="index.html">14. Unit Testing</a></li>
    <li class="active">14.5. TDD in Action</li>
</ol>



<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-1 content ">

    
  <div class="section" id="tdd-in-action">
<h1>14.5. TDD in Action<a class="headerlink" href="#tdd-in-action" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://repl.it/&#64;launchcode/Transmission-processor-TDD-starter" target="_blank">Fork our starter code repl.it<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>
and follow along as we implement a project using TDD.</p>
<p>We need to write a Node module to process transmissions from the
<a class="reference external" href="https://voyager.jpl.nasa.gov/mission/" target="_blank">Voyager1 probe<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>.</p>
<div class="admonition-example admonition">
<p class="first admonition-title"><i class="fas fa-binoculars" aria-hidden="true"></i>Example</p>
<p>Transmission</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;1410::&lt;932829840830053761&gt;&quot;</span>
</pre></div>
</div>
<p>Expected Result</p>
<div class="last highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">id</span><span class="o">:</span> <span class="mi">1410</span><span class="p">,</span>
   <span class="nx">rawData</span><span class="o">:</span> <span class="mi">932829840830053761</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="requirements">
<h2>14.5.1. Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>The features for this project have already been broken down into
small testable units. Let's review them and then we will
take it slow, one step at a time.</p>
<ol class="arabic simple">
<li>Take in a transmission string and return an object.</li>
<li>Return <code class="docutils literal notranslate"><span class="pre">-1</span></code> if the transmission does NOT contain <code class="docutils literal notranslate"><span class="pre">&quot;::&quot;</span></code>.</li>
<li>Returned object should contain an <code class="docutils literal notranslate"><span class="pre">id</span></code> property<ul>
<li>The value of <code class="docutils literal notranslate"><span class="pre">id</span></code> is the part of the transmission <em>before</em> the <code class="docutils literal notranslate"><span class="pre">&quot;::&quot;</span></code></li>
</ul>
</li>
<li>The <code class="docutils literal notranslate"><span class="pre">id</span></code> property should be of type <code class="docutils literal notranslate"><span class="pre">Number</span></code></li>
<li>Returned object should contain a <code class="docutils literal notranslate"><span class="pre">rawData</span></code> property<ul>
<li>The value of <code class="docutils literal notranslate"><span class="pre">rawData</span></code> is the part of the transmission <em>after</em> the <code class="docutils literal notranslate"><span class="pre">&quot;::&quot;</span></code></li>
</ul>
</li>
<li>Return -1 for the value <code class="docutils literal notranslate"><span class="pre">rawData</span></code> if the <code class="docutils literal notranslate"><span class="pre">rawData</span></code> part of the transmission does NOT start with <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> and end with <code class="docutils literal notranslate"><span class="pre">&gt;</span></code></li>
</ol>
</div>
<div class="section" id="requirement-1">
<h2>14.5.2. Requirement #1<a class="headerlink" href="#requirement-1" title="Permalink to this headline">¶</a></h2>
<p><em>Requirement:</em> Take in a transmission string and return an object.</p>
<p>To get started on this we need to:</p>
<ol class="loweralpha simple">
<li>Create a blank test function.</li>
<li>Give the test a name that is a clear, testable statement.</li>
</ol>
<p>Creating a blank test is easy, go to <code class="docutils literal notranslate"><span class="pre">processor.spec.js</span></code> and add an empty test method.
Tests in Jasmine are declared with an <code class="docutils literal notranslate"><span class="pre">it</span></code> function.
Remember that tests go inside of the <code class="docutils literal notranslate"><span class="pre">describe</span></code> function, which along with the string
parameter describe the group of tests inside.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;assert&#39;</span><span class="p">);</span>

<span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;transmission processor&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

   <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>

   <span class="p">});</span>

<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>Give the test the name <code class="docutils literal notranslate"><span class="pre">&quot;takes</span> <span class="pre">a</span> <span class="pre">string</span> <span class="pre">and</span> <span class="pre">returns</span> <span class="pre">an</span> <span class="pre">object&quot;</span></code>.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;assert&#39;</span><span class="p">);</span>

<span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;transmission processor&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

   <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;takes a string returns an object&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

   <span class="p">});</span>

<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>Now that we identified a clear goal for the test, let's add logic and <code class="docutils literal notranslate"><span class="pre">assert</span></code> calls
in the test to verify the desired behavior. <em>But wait...</em> we haven't added anything
except an empty test at this point. There isn't any actual code to verify. That's okay,
this is part of the TDD process.</p>
<p>We are going to think about and visualize
how this feature should be implemented in code. Then we will write out in the test how
this new code will be used.</p>
<p>We need to think of something that will satisfy the statement
<code class="docutils literal notranslate"><span class="pre">it(&quot;takes</span> <span class="pre">a</span> <span class="pre">string</span> <span class="pre">and</span> <span class="pre">returns</span> <span class="pre">an</span> <span class="pre">object&quot;</span></code>.
The <code class="docutils literal notranslate"><span class="pre">it</span></code> will be a function that is imported from a module. Below on line 2,
a <code class="docutils literal notranslate"><span class="pre">processor</span></code> function is imported from the <code class="docutils literal notranslate"><span class="pre">processor.js</span></code> module.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;assert&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">processor</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../processor.js&#39;</span><span class="p">);</span>

<span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;transmission processor&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

   <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;takes a string and returns an object&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>

   <span class="p">});</span>

<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>We have an idea for a function named <code class="docutils literal notranslate"><span class="pre">processor</span></code> and we have imported it.
Keep in mind this function only exists as a concept and we are writing a test
to see if this concept makes sense.</p>
<p>Now for the real heart of the test. We are going to use <code class="docutils literal notranslate"><span class="pre">assert.strictEqual</span></code> to
verify that if we pass a string to <code class="docutils literal notranslate"><span class="pre">processor</span></code>, an object is returned.
Carefully review lines 7 and 8 shown below.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;assert&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">processor</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../processor.js&#39;</span><span class="p">);</span>

<span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;transmission processor&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

   <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;takes a string and returns an object&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">processor</span><span class="p">(</span><span class="s2">&quot;9701::&lt;489584872710&gt;&quot;</span><span class="p">);</span>
      <span class="nx">assert</span><span class="p">.</span><span class="nx">strictEqual</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">result</span><span class="p">,</span> <span class="s2">&quot;object&quot;</span><span class="p">);</span>
   <span class="p">});</span>

<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>On line 7 the <code class="docutils literal notranslate"><span class="pre">processor</span></code> function is called, with the value being stored in a <code class="docutils literal notranslate"><span class="pre">result</span></code>
variable. On line 8 the result of the expression <code class="docutils literal notranslate"><span class="pre">typeof</span> <span class="pre">result</span></code> is compared to the value
<code class="docutils literal notranslate"><span class="pre">&quot;object&quot;</span></code>. Reminder that the <a class="reference internal" href="../data-and-variables/values-and-data-types.html#typeof"><span class="std std-ref">typeof operator</span></a> returns a string representation
of a type. If <code class="docutils literal notranslate"><span class="pre">typeof</span> <span class="pre">result</span></code> evaluates to the string <code class="docutils literal notranslate"><span class="pre">&quot;object&quot;</span></code>, then we know that <code class="docutils literal notranslate"><span class="pre">processor</span></code>
returned an object.</p>
<div class="section" id="code-red">
<h3>14.5.2.1. Code Red<a class="headerlink" href="#code-red" title="Permalink to this headline">¶</a></h3>
<p>Let's run the test! Click the <code class="docutils literal notranslate"><span class="pre">run</span> <span class="pre">&gt;</span></code> button in your repl.it.
You should see an error about <code class="docutils literal notranslate"><span class="pre">processor.js</span></code> not existing. This makes sense, because we have not
created the file yet. We are officially in the Red phase of Red, Green, Refactor!</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Error: Cannot find module &#39;../processor.js&#39;
</pre></div>
</div>
</div>
<div class="section" id="go-green">
<h3>14.5.2.2. Go Green!<a class="headerlink" href="#go-green" title="Permalink to this headline">¶</a></h3>
<p>Now that we have a failing test, we have only one choice. Make it pass.</p>
<ol class="loweralpha simple">
<li>Add a <code class="docutils literal notranslate"><span class="pre">processor.js</span></code> file to your repl.it.</li>
<li>Inside of the module declare a <code class="docutils literal notranslate"><span class="pre">processor</span></code> function that takes a parameter and returns an object.</li>
</ol>
<p>Contents of the new <code class="docutils literal notranslate"><span class="pre">processor.js</span></code> file.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">process</span><span class="p">(</span><span class="nx">transmission</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">return</span> <span class="p">{};</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">process</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<div class="figure" id="id1">
<img alt="Screen shot showing processor.js file added to replit with function in it." src="../../_images/processor-module-added-to-replit.png" />
<p class="caption"><span class="caption-text">processor.js file</span></p>
</div>
<p><em>Run the test again.</em></p>
<p>We did it! <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">spec,</span> <span class="pre">0</span> <span class="pre">failures</span></code> means 1 passing
test. In repl.it you have to imagine the satisfying green color of a passing test.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1 spec, 0 failures
Finished in 0.011 seconds
</pre></div>
</div>
</div>
<div class="section" id="refactor-if-needed">
<h3>14.5.2.3. Refactor if Needed<a class="headerlink" href="#refactor-if-needed" title="Permalink to this headline">¶</a></h3>
<p>This solution is very simple and does not need to be improved. The refactor step
does not always lead to an actual changing of your code. The most important part is to
review your code to make sure that it's efficient and meets your team's standards.</p>
</div>
</div>
<div class="section" id="requirement-2">
<h2>14.5.3. Requirement #2<a class="headerlink" href="#requirement-2" title="Permalink to this headline">¶</a></h2>
<p><em>Requirement:</em> Return <code class="docutils literal notranslate"><span class="pre">-1</span></code> if the transmission does NOT contain <code class="docutils literal notranslate"><span class="pre">&quot;::&quot;</span></code>.</p>
<p>Next we have a negative test requirement that tells us what should happen if the data is invalid.
Before jumping into the code, let's review the steps we took to implement requirement #1.</p>
<p>Review of TDD process:</p>
<ol class="arabic simple">
<li>Create a blank test function.</li>
<li>Give the test a name that is a clear, testable statement.</li>
<li>Come up with test data that will trigger the described behavior.</li>
<li>Think about what is needed, then write code that fulfills the stated behavior.</li>
<li>Run the test and see the it fail.</li>
<li>Implement the new code or feature used in the test.</li>
<li>Run the test and see it pass.</li>
<li>Review to see if refactor needed.</li>
</ol>
<p>For requirement #2, the solution for <em>steps 1 - 4</em> can be seen on lines <em>11 - 14</em> below.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;assert&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">processor</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../processor.js&#39;</span><span class="p">);</span>

<span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;transmission processor&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

   <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;takes a string and returns an object&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">processor</span><span class="p">(</span><span class="s2">&quot;9701::&lt;489584872710&gt;&quot;</span><span class="p">);</span>
      <span class="nx">assert</span><span class="p">.</span><span class="nx">strictEqual</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">result</span><span class="p">,</span> <span class="s2">&quot;object&quot;</span><span class="p">);</span>
   <span class="p">});</span>

   <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;returns -1 if &#39;::&#39; not found&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">processor</span><span class="p">(</span><span class="s2">&quot;9701&lt;489584872710&gt;&quot;</span><span class="p">);</span>
      <span class="nx">assert</span><span class="p">.</span><span class="nx">strictEqual</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
   <span class="p">});</span>

<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>Now for <em>step 5</em>, run the test and see it fail. When you run the tests, you should see the below
error message. Notice that <code class="docutils literal notranslate"><span class="pre">-1</span></code> was the expected value, but the actual value was <code class="docutils literal notranslate"><span class="pre">'object'</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Failures:
1) transmission processor returns -1 if &#39;::&#39; not found
Message:
 AssertionError [ERR_ASSERTION]: Input A expected to strictly equal input B:
 + expected - actual

 - &#39;object&#39;
 + -1
</pre></div>
</div>
<p>Next is <em>step 6</em>, write code that will make the test pass. Go to <code class="docutils literal notranslate"><span class="pre">processor.js</span></code> and update the <code class="docutils literal notranslate"><span class="pre">processor</span></code> function
to check the <code class="docutils literal notranslate"><span class="pre">transmission</span></code> argument for the presence of <code class="docutils literal notranslate"><span class="pre">'::'</span></code>.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">process</span><span class="p">(</span><span class="nx">transmission</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nx">transmission</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Data is invalid</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">return</span> <span class="p">{};</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">process</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Lucky <em>step 7</em> is to run the tests again. They should both pass.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>2 specs, 0 failures
Finished in 0.035 seconds
</pre></div>
</div>
<p>Finally <em>step 8</em> is to review the code to see if it needs to be refactored. As with the first requirement
our code is quite simple and can not be improved at this time.</p>
</div>
<div class="section" id="requirement-3">
<h2>14.5.4. Requirement #3<a class="headerlink" href="#requirement-3" title="Permalink to this headline">¶</a></h2>
<p><em>Requirement:</em> Returned object should contain an <code class="docutils literal notranslate"><span class="pre">id</span></code> property.
The <code class="docutils literal notranslate"><span class="pre">id</span></code> is the part of the transmission <em>before</em> the <code class="docutils literal notranslate"><span class="pre">&quot;::&quot;</span></code></p>
<p>The same steps will be followed, even though they are not explicitly listed.</p>
<p>See lines <em>16 - 19</em> to see the test added for this requirement. To test
this case <code class="docutils literal notranslate"><span class="pre">notStrictEqual</span></code> was used, which is checking if the two values
are NOT equal. <code class="docutils literal notranslate"><span class="pre">notStrictEqual</span></code> is used to make sure that <code class="docutils literal notranslate"><span class="pre">result.id</span></code>
is NOT equal to <code class="docutils literal notranslate"><span class="pre">undefined</span></code>. Remember that if you reference a property on an
object that does NOT exist, <code class="docutils literal notranslate"><span class="pre">undefined</span></code> is returned.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;assert&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">processor</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../processor.js&#39;</span><span class="p">);</span>

<span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;transmission processor&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

   <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;takes a string returns an object&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">processor</span><span class="p">(</span><span class="s2">&quot;9701::&lt;489584872710&gt;&quot;</span><span class="p">);</span>
      <span class="nx">assert</span><span class="p">.</span><span class="nx">strictEqual</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">result</span><span class="p">,</span> <span class="s2">&quot;object&quot;</span><span class="p">);</span>
   <span class="p">});</span>

   <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;returns -1 if &#39;::&#39; not found&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">processor</span><span class="p">(</span><span class="s2">&quot;9701&lt;489584872710&gt;&quot;</span><span class="p">);</span>
      <span class="nx">assert</span><span class="p">.</span><span class="nx">strictEqual</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
   <span class="p">});</span>

   <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;returns id in object&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
     <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">processor</span><span class="p">(</span><span class="s2">&quot;9701::&lt;489584872710&gt;&quot;</span><span class="p">);</span>
     <span class="nx">assert</span><span class="p">.</span><span class="nx">notStrictEqual</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">);</span>
   <span class="p">});</span>

<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>The fail message looks a little different than what we have seen. The phrase
&quot;Identical input passed to notStrictEqual&quot; lets us know that the two values
were equal when we didn't expect them to be.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Failures:
1) transmission processor returns id in object
Message:
   AssertionError [ERR_ASSERTION]: Identical input passed to notStrictEqual: undefined
</pre></div>
</div>
<p>The object returned from <code class="docutils literal notranslate"><span class="pre">processor</span></code> doesn't have an id property. We need to
split the transmission on <code class="docutils literal notranslate"><span class="pre">'::'</span></code> and then add that value to the object with
the key <code class="docutils literal notranslate"><span class="pre">id</span></code>. See solution in <code class="docutils literal notranslate"><span class="pre">processor.js</span></code> below.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">process</span><span class="p">(</span><span class="nx">transmission</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nx">transmission</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Data is invalid</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="kd">let</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">transmission</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">);</span>
   <span class="k">return</span> <span class="p">{</span>
      <span class="nx">id</span><span class="o">:</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
   <span class="p">};</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">process</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Run the tests again. That did it. The tests pass! :-)</p>
<p>Line 6 splits <code class="docutils literal notranslate"><span class="pre">transmission</span></code> into the <code class="docutils literal notranslate"><span class="pre">parts</span></code> array, and line 8 assigns
the first entry in the array to the key <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>3 specs, 0 failures
Finished in 0.011 seconds
</pre></div>
</div>
</div>
<div class="section" id="requirement-4">
<h2>14.5.5. Requirement #4<a class="headerlink" href="#requirement-4" title="Permalink to this headline">¶</a></h2>
<p><em>Requirement:</em> The <code class="docutils literal notranslate"><span class="pre">id</span></code> property should be of type <code class="docutils literal notranslate"><span class="pre">Number</span></code></p>
<p>Again the same steps are followed, though not listed.</p>
<p>New test to be added to <code class="docutils literal notranslate"><span class="pre">specs/processor.spec.js</span></code></p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;converts id to a number&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
   <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">processor</span><span class="p">(</span><span class="s2">&quot;9701::&lt;489584872710&gt;&quot;</span><span class="p">);</span>
   <span class="nx">assert</span><span class="p">.</span><span class="nx">strictEqual</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="mi">9701</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>Fail Message</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Failures:
1) transmission processor converts id to a number
Message:
   AssertionError [ERR_ASSERTION]: Input A expected to strictly equal input B:
   + expected - actual

   - &#39;9701&#39;
   + 9701
</pre></div>
</div>
<p>Convert the id part of the string to be of type <code class="docutils literal notranslate"><span class="pre">number</span></code>.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">process</span><span class="p">(</span><span class="nx">transmission</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nx">transmission</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Data is invalid</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="kd">let</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">transmission</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">);</span>
   <span class="k">return</span> <span class="p">{</span>
      <span class="nx">id</span><span class="o">:</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
   <span class="p">};</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">process</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Now for the great feeling of a passing tests!</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>4 specs, 0 failures
Finished in 0.061 seconds
</pre></div>
</div>
<div class="admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p class="last">You may be wondering what happens if that data is bad and the id can't be
turned into a number. That is a negative test case related to this feature
and is left for you to address in the final section.</p>
</div>
</div>
<div class="section" id="requirement-5">
<h2>14.5.6. Requirement #5<a class="headerlink" href="#requirement-5" title="Permalink to this headline">¶</a></h2>
<p><em>Requirement:</em> Returned object should contain a <code class="docutils literal notranslate"><span class="pre">rawData</span></code> property. The <code class="docutils literal notranslate"><span class="pre">rawData</span></code>
is the part of the transmission <em>after</em> the <code class="docutils literal notranslate"><span class="pre">&quot;::&quot;</span></code></p>
<p>New test to be added to <code class="docutils literal notranslate"><span class="pre">specs/processor.spec.js</span></code></p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;returns rawData in object&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
   <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">processor</span><span class="p">(</span><span class="s2">&quot;9701::&lt;487297403495720912&gt;&quot;</span><span class="p">);</span>
   <span class="nx">assert</span><span class="p">.</span><span class="nx">notStrictEqual</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">rawData</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>Fail Message</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Failures:
1) transmission processor returns rawData in object
Message:
   AssertionError [ERR_ASSERTION]: Identical input passed to notStrictEqual: undefined
</pre></div>
</div>
<p>We need to extract the rawData from the second half of the transmission string after it's
been split. Then return that in the object.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">process</span><span class="p">(</span><span class="nx">transmission</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nx">transmission</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Data is invalid</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="kd">let</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">transmission</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">);</span>
   <span class="kd">let</span> <span class="nx">rawData</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
   <span class="k">return</span> <span class="p">{</span>
      <span class="nx">id</span><span class="o">:</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
      <span class="nx">rawData</span><span class="o">:</span> <span class="nx">rawData</span>
   <span class="p">};</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">process</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>It's that time again, our tests pass!</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>5 specs, 0 failures
Finished in 0.041 seconds
</pre></div>
</div>
</div>
<div class="section" id="requirement-6">
<h2>14.5.7. Requirement #6<a class="headerlink" href="#requirement-6" title="Permalink to this headline">¶</a></h2>
<p><em>Requirement:</em> Return -1 for the value <code class="docutils literal notranslate"><span class="pre">rawData</span></code> if the <code class="docutils literal notranslate"><span class="pre">rawData</span></code> part of
the transmission does NOT start with <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> and end with <code class="docutils literal notranslate"><span class="pre">&gt;</span></code></p>
<p>Let's think about what test data to use for this requirement. What ways could the
transmission data be invalid?</p>
<ol class="arabic simple">
<li>It could be missing <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> at the beginning</li>
<li>It could be missing <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> at the end</li>
<li>It could be missing both <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&gt;</span></code></li>
<li>Has <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> but is in the wrong place</li>
<li>Has <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> but is in the wrong place</li>
</ol>
<p>All these cases need to be covered by a test. Let's start with #1, which
is missing <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> at the beginning.</p>
<p>New test to be added to <code class="docutils literal notranslate"><span class="pre">specs/processor.spec.js</span></code></p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;returns -1 for rawData if missing &lt; at position 0&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
   <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">processor</span><span class="p">(</span><span class="s2">&quot;9701::487297403495720912&gt;&quot;</span><span class="p">);</span>
   <span class="nx">assert</span><span class="p">.</span><span class="nx">strictEqual</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">rawData</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>Fail Message</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Failures:
1) transmission processor returns -1 for rawData if missing &lt; at position 0
Message:
   AssertionError [ERR_ASSERTION]: Input A expected to strictly equal input B:
   + expected - actual

   - &#39;487297403495720912&gt;&#39;
   + -1
</pre></div>
</div>
<p>New code added to <code class="docutils literal notranslate"><span class="pre">processor.js</span></code> to make tests pass. Note that we don't simply return
<code class="docutils literal notranslate"><span class="pre">-1</span></code>, the requirement is to return the object and set the value of <code class="docutils literal notranslate"><span class="pre">rawData</span></code> to <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">process</span><span class="p">(</span><span class="nx">transmission</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nx">transmission</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Data is invalid</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="kd">let</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">transmission</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">);</span>
   <span class="kd">let</span> <span class="nx">rawData</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
   <span class="k">if</span> <span class="p">(</span><span class="nx">rawData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!==</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">rawData</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">return</span> <span class="p">{</span>
      <span class="nx">id</span><span class="o">:</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
      <span class="nx">rawData</span><span class="o">:</span> <span class="nx">rawData</span>
   <span class="p">};</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">process</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>You know what's next, our tests pass!</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>6 specs, 0 failures
Finished in 0.056 seconds
</pre></div>
</div>
<div class="admonition-try-it admonition">
<p class="first admonition-title"><i class="fas fa-puzzle-piece" aria-hidden="true"></i>Try It!</p>
<p>The test data we used was missing <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> at the beginning. Add tests
to cover these cases. <code class="docutils literal notranslate"><span class="pre">-1</span></code> should be returned as the value for
<code class="docutils literal notranslate"><span class="pre">rawData</span></code> for all of these.</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">&quot;9701::8729740349572&gt;0912&quot;</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;9701::4872&lt;97403495720912&quot;</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;9701::487297403495720912&quot;</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;9701::&lt;487297403495&lt;720912&gt;&quot;</span></code></li>
</ul>
</div>
</div>
<div class="section" id="use-tdd-to-add-these-features">
<h2>14.5.8. Use TDD to Add These Features<a class="headerlink" href="#use-tdd-to-add-these-features" title="Permalink to this headline">¶</a></h2>
<p>Use the steps demonstrated above to implement all or some of the below features.
Take your time, you can do it!</p>
<ol class="arabic simple">
<li>Trim leading and trailing whitespace from <code class="docutils literal notranslate"><span class="pre">transmission</span></code>.</li>
<li>Return -1 if the <code class="docutils literal notranslate"><span class="pre">id</span></code> part of the <code class="docutils literal notranslate"><span class="pre">transmission</span></code> can not be converted to a number.</li>
<li>Return -1 if more than one <code class="docutils literal notranslate"><span class="pre">&quot;::&quot;</span></code> found in <code class="docutils literal notranslate"><span class="pre">transmission</span></code></li>
<li>Return -1 for value of <code class="docutils literal notranslate"><span class="pre">rawData</span></code> if anything besides numbers are present</li>
<li>Allow for multiple <code class="docutils literal notranslate"><span class="pre">rawData</span></code> values<ul>
<li><code class="docutils literal notranslate"><span class="pre">rawData</span></code> would be returned as an array of numbers</li>
<li>Get the new test working and then fix any broken existing tests</li>
<li>Example Transmission:  <code class="docutils literal notranslate"><span class="pre">&quot;9701::&lt;21212.232323.242424&gt;&quot;</span></code></li>
<li>Result: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">id:</span> <span class="pre">9701,</span> <span class="pre">rawData:</span> <span class="pre">[21212,232323,242424]</span> <span class="pre">}</span></code></li>
</ul>
</li>
</ol>
</div>
</div>



    
    <nav aria-label="Next and Previous Pages">
      <ul class="pager">
        
        <li class="previous"><a href="tdd.html"><span aria-hidden="true">&larr;</span> 14.4. Test-Driven Development</a></li>
        
        
        <li class="next"><a href="exercises.html">14.6. Exercises: Unit Testing <span aria-hidden="true">&rarr;</span></a></li>
        
      </ul>
    </nav>
    
    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>